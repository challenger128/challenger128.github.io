---
title: –ü–µ—Ä–∏–æ–¥ –ü–∏–∑–∞–Ω–æ
date: 2021-11-24 22:10:00 +0500
categories: [–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –æ–ª–∏–º–ø–∏–∞–¥–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ]
tags: [–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ç–µ–æ—Ä–∏—è —á–∏—Å–µ–ª, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ]
comments: false
math: true
---

–î–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –ø—Ä–æ—Å–ø–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ [–∑–∞–¥–∞—á–µ–π](https://stepik.org/lesson/13228/step/8?unit=3414) –∏–∑ –∫—É—Ä—Å–∞ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º. –í –Ω–µ–π –Ω—É–∂–Ω–æ –±—ã–ª–æ –Ω–∞–π—Ç–∏ \\( F_{n} \bmod m \\), –≥–¥–µ \\( 1 \leq n \leq 10^{18} \\) –∏ \\( 1 \leq m \leq 10^{5} \\). –°—Ä–∞–∑—É –æ–≥–æ–≤–æ—Ä—é—Å—å, —á—Ç–æ —É –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å –∏ –¥—Ä—É–≥–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—á–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏, –Ω–æ –º–Ω–µ –±—ã —Ö–æ—Ç–µ–ª–æ—Å—å —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–æ–µ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã —Å–º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö.

# –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–∏–æ–¥ –ü–∏–∑–∞–Ω–æ –∏ –¥–ª—è —á–µ–≥–æ –æ–Ω –Ω—É–∂–µ–Ω –≤ –∑–∞–¥–∞—á–µ ‚ùî

–£—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –§–∏–±–æ–Ω–∞—á—á–∏ –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É –º–æ–¥—É–ª—é \\( m \\) –ø–µ—Ä–∏–æ–¥–∏—á–Ω–∞, –¥–ª–∏–Ω–Ω—É –¥–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –º—ã –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–æ–º –ü–∏–∑–∞–Ω–æ –∏ –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –∫–∞–∫ \\( \pi(n) \\).

–ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç—å —Ç—è–∂–µ–ª–æ, –ø–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π—Ç–µ –µ–≥–æ –¥–æ–∫–∞–∂–µ–º. –ó–∞–º–µ–Ω–∏–º —á–∏—Å–ª–∞ –§–∏–±–æ–Ω–∞—á—á–∏ –Ω–∞ –æ—Å—Ç–∞—Ç–∫–∏ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ \\( m \\). –ü—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ –Ω–∞ \\( m \\) –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç \\( 0 \\) –¥–æ \\( m - 1 \\), —Ç–∞–∫ —á—Ç–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∫–æ–Ω–µ—á–Ω–æ–µ —á–∏—Å–ª–æ. –ï—Å–ª–∏ —è –∑–Ω–∞—é –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å —á–ª–µ–Ω–∞, —Ç–æ —è –Ω–µ –∑–Ω–∞—é, –∫–∞–∫–æ–π –æ—Å—Ç–∞—Ç–æ–∫ –±—É–¥–µ—Ç —É —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–ª–∏ –∫–∞–∫–æ–π –æ—Å—Ç–∞—Ç–æ–∫ –±—ã–ª —É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —á–∏—Å–ª–∞ –§–∏–±–æ–Ω–∞—á—á–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ —Å—É–º–º–∞ –¥–≤—É—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —á–∏—Å–µ–ª. –¢–æ–≥–¥–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–∞—Ä—ã —Å–æ—Å–µ–¥–Ω–∏—Ö —á–∏—Å–µ–ª. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä –ø–æ –º–æ–¥—É–ª—é \\( m \\) –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ \\( m^{2} \\).

–í—ã–ø–∏—à–µ–º –ø–µ—Ä–≤—ã–µ \\( m^{2} + 1 \\) –ø–∞—Ä—ã —á–∏—Å–µ–ª –§–∏–±–æ–Ω–∞—á—á–∏. \\( (F_{0}, F_{1}), (F_{1}, F_{2}), ... (F_{m^{2}}, F_{m^{2} + 1}) \\). –¢–æ–≥–¥–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É –î–∏—Ä–∏—Ö–ª–µ –Ω–∞–π–¥–µ—Ç—Å—è –¥–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä—ã. –ü—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç –ø–∞—Ä–∞ \\( (F_{l}, F_{l + 1})\\) –∏ \\( (F_{l + k}, F_{l + k + 1})\\).

–¢–æ–≥–¥–∞ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É–ª—É —á–ª–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—Ä–∞–∑–∏–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —á–ª–µ–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã. –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –æ–Ω–∏ –±—É–¥—É—Ç —Å—Ä–∞–≤–Ω–∏–º—ã –ø–æ –Ω–∞—à–µ–º—É –º–æ–¥—É–ª—é, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—à–∏ –ø–∞—Ä—ã —Ä–∞–≤–Ω—ã.

- \\( F_{l - 1} = F_{l + 1} - F_{l} \\).
- \\( F_{l + k - 1} = F_{l + k + 1} - F_{l + k} \\).
- \\( F_{l - 1} \equiv F_{l + k - 1} \ (\bmod m) \\).
- –ò –≤–æ–æ–±—â–µ –≥–æ–≤–æ—Ä—è \\( F_{l + v} \equiv F_{l + k + v} \ (\bmod m) \\), —á—Ç–æ –∏ –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å.

–û—Ç–º–µ—Ç–∏–º –æ–¥–Ω–æ –≤–∞–∂–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–∞ –ü–∏–∑–∞–Ω–æ \\( \forall m \in \mathbb{Z} \\) \\( \pi(m) \leq 6 \cdot m \\). –¢–µ–ø–µ—Ä—å –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—é –ø–µ—Ä–∏–æ–¥–∞, —Ç–∞–∫ –∫–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫—É \\( O(m) \\).

# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è. –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ –ü–∏–∑–∞–Ω–æ. üë®‚Äçüíª

–ü—Ä–æ—Å—Ç–µ–π—à–∏–π –∫–æ–¥, –≤—ã—á–∏—Å–ª—è—é—â–∏–π –ø–µ—Ä–∏–æ–¥ –ü–∏–∑–∞–Ω–æ –∑–∞ –ª–∏–Ω–µ–π–Ω—É—é –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫—É –æ—Ç –º–æ–¥—É–ª—è.

```python
from typing import List


def pisano_period(m: int) -> List[int]:
    a, b, period = 1, 1, [0]
    while not (a == 0 and b == 1):
        period.append(a)
        a, b = b % m, (a + b) % m
    return period
```

# –°–≤–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–∏–æ–¥–∞ –ü–∏–∑–∞–Ω–æ üå∂Ô∏è

–ü–æ–¥—ã—Ç–æ–∂–∏–º –∏ –ø—Ä–∏–≤–µ–¥–µ–º –±–µ–∑ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–∏–æ–¥–∞.

* –ï—Å–ª–∏ \\( n \\) –∏ \\( m \\) –≤–∑–∞–∏–º–Ω–æ–ø—Ä–æ—Å—Ç—ã–µ, —Ç–æ \\( \pi(n \cdot m) = lcm(\pi(n), \pi(m)) \\). –≠—Ç–æ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –∫–∏—Ç–∞–π—Å–∫–æ–π —Ç–µ–æ—Ä–µ–º—ã –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö.
* –î–ª—è –≤—Å–µ—Ö —Ç–æ—á–Ω—ã—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª \\( p \\) –æ—Ç 1 –¥–æ –º–∏–ª–ª–∏–æ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è \\( \pi(p^{n}) = p^{n-1} \cdot \pi(p) \\), –æ–¥–Ω–∞–∫–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –¥–ª—è –≤—Å–µ—Ö —á–∏—Å–µ–ª, –ø–æ–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ.
* –ï—Å–ª–∏ \\( p \\) –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ, —Ç–æ:
  * –ø—Ä–∏ \\( p \equiv \pm 1 \ (\bmod 5) \\), —á–∏—Å–ª–æ \\( \pi(p) \\) —è–≤–ª—è–µ—Ç—Å—è –¥–µ–ª–∏—Ç–µ–ª–µ–º —á–∏—Å–ª–∞ \\( p-1 \\)
  * –ø—Ä–∏ \\( p \equiv \pm 2 \ (\bmod 5) \\), —á–∏—Å–ª–æ \\( \pi(p) \\) —è–≤–ª—è–µ—Ç—Å—è –¥–µ–ª–∏—Ç–µ–ª–µ–º —á–∏—Å–ª–∞ \\( 2 \cdot (p + 1) \\)
* \\( \forall m \in \mathbb{Z} \\) \\( \pi(m) \leq 6 \cdot m \\)


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (Online Judge ‚öñÔ∏è)

–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –Ω–∏–∂–µ –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–ª–æ–∂–Ω—ã–º–∏, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–æ –≤—Å–µ–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –ø–µ—Ä–∏–æ–¥–∞.

- [e-olymp](https://www.e-olymp.com/ru/problems/6390)
- [spoj](https://www.spoj.com/problems/PISANO/)